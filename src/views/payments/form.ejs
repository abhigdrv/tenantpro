<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('../partials/head') %>
    <title><%= title %></title>
</head>
<body>
    <%- include('../partials/header') %>
    <main>
        <%- include('../partials/sidebar') %>
        <section class="content">
            <h2><%= title %></h2>
            <form action="/agent/payments/<%= payment ? payment.id + '/edit' : '' %>" method="POST">
                <div class="form-group">
                    <label for="leaseId">Lease Agreement:</label>
                    <select name="leaseId" id="leaseId" required>
                        <% leases.forEach(lease => { %>
                            <option value="<%= lease.id %>" <%= payment && payment.leaseId === lease.id ? 'selected' : '' %>>
                                Lease #<%= lease.id %> - <%= lease.tenant.firstName %> <%= lease.tenant.lastName %> (<%= lease.room.property.name %>)
                            </option>
                        <% }); %>
                    </select>
                </div>
                <div class="form-group">
                    <label for="amount">Amount:</label>
                    <input type="number" step="0.01" name="amount" id="amount" value="<%= payment ? payment.amount : '' %>" required>
                </div>
                <div class="form-group">
                    <label for="paymentDate">Payment Date:</label>
                    <input type="date" name="paymentDate" id="paymentDate" value="<%= payment ? payment.paymentDate.toISOString().split('T')[0] : '' %>" required>
                </div>
                <div class="form-group">
                    <label for="paymentForMonth">Payment For Month:</label>
                    <input type="date" name="paymentForMonth" id="paymentForMonth" value="<%= payment ? payment.paymentForMonth.toISOString().split('T')[0] : '' %>" required>
                </div>
                <div class="form-group">
                    <label for="note">Note:</label>
                    <input type="text" name="note" id="note" value="<%= payment ? payment.note : '' %>">
                </div>
                <div class="form-group">
                    <label for="status">Status:</label>
                    <select name="status" id="status" required>
                        <option value="paid" <%= payment && payment.status === 'paid' ? 'selected' : '' %>>Paid</option>
                        <option value="overdue" <%= payment && payment.status === 'overdue' ? 'selected' : '' %>>Overdue</option>
                    </select>
                </div>
                <button type="submit" class="btn">Save Payment</button>
            </form>
        </section>
    </main>
    <%- include('../partials/footer') %>
</body>
</html>